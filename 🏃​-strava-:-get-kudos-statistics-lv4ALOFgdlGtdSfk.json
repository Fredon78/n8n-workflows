{"createdAt":"2025-04-10T14:31:17.234Z","updatedAt":"2025-04-14T14:43:41.000Z","id":"lv4ALOFgdlGtdSfk","name":"🏃​ Strava : Get Kudos Statistics","active":false,"nodes":[{"parameters":{"operation":"getAll","limit":40},"id":"f14b1970-7006-445b-a3cd-b35c048ca58f","name":"Get Activities","type":"n8n-nodes-base.strava","typeVersion":1,"position":[-60,40],"credentials":{"stravaOAuth2Api":{"id":"cXVlrMvvHqfU0Clq","name":"Strava account"}}},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-260,40],"id":"f3478300-a126-4d70-9e12-27eea34712d5","name":"When clicking ‘Test workflow’"},{"parameters":{"operation":"getKudos","activityId":"={{ $json.id }}","returnAll":true},"id":"fee3e43f-5c73-4fdf-8d39-5b867f990afa","name":"Get Kudos2","type":"n8n-nodes-base.strava","typeVersion":1,"position":[140,40],"credentials":{"stravaOAuth2Api":{"id":"cXVlrMvvHqfU0Clq","name":"Strava account"}}},{"parameters":{"jsCode":"const activityId = $json.activityId;\n\nreturn items.map(kudoer => {\n  return {\n    json: {\n      name: `${kudoer.json.firstname} ${kudoer.json.lastname}`,\n      activityId,\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[360,40],"id":"1fc6a24e-8c90-4d2b-8f2c-9f9cf3289ec6","name":"Merge FirstName Lastname"},{"parameters":{"jsCode":"\nconst counts = {};\n\nfor (const item of items) {\n  const name = item.json.name;\n  if (!counts[name]) {\n    counts[name] = { count: 0};\n  }\n  counts[name].count += 1;\n}\n\nreturn Object.entries(counts).map(([name, data]) => ({\n  json: {\n    name,\n    kudosCount: data.count,\n  }\n}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[580,40],"id":"81f58eae-dcac-4f28-970c-e79e9c2bf3ce","name":"Count Kudos by Kudoers"},{"parameters":{"jsCode":"items.sort((a, b) => b.json.kudosCount - a.json.kudosCount);\nreturn items;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[780,40],"id":"cfe744f2-e23d-4246-80f6-279a23eb9b1f","name":"Code"},{"parameters":{"operation":"appendOrUpdate","documentId":{"__rl":true,"value":"18IV3P_5Ic0NedPyZcnn5uusRBd2cZuvWQN4xfIGwk1U","mode":"list","cachedResultName":"Strava","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18IV3P_5Ic0NedPyZcnn5uusRBd2cZuvWQN4xfIGwk1U/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Kudos","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18IV3P_5Ic0NedPyZcnn5uusRBd2cZuvWQN4xfIGwk1U/edit#gid=0"},"columns":{"mappingMode":"autoMapInputData","value":{},"matchingColumns":[],"schema":[{"id":"name","displayName":"name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"kudosCount","displayName":"kudosCount","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[1000,40],"id":"81bbdd71-e2f9-4b34-9d5e-5ddcfedc63c3","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"Ep9hEm7uDQjYE3SD","name":"Google Sheets account"}}}],"connections":{"Get Activities":{"main":[[{"node":"Get Kudos2","type":"main","index":0}]]},"When clicking ‘Test workflow’":{"main":[[{"node":"Get Activities","type":"main","index":0}]]},"Get Kudos2":{"main":[[{"node":"Merge FirstName Lastname","type":"main","index":0}]]},"Merge FirstName Lastname":{"main":[[{"node":"Count Kudos by Kudoers","type":"main","index":0}]]},"Count Kudos by Kudoers":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"6234038c-9587-40e2-a078-5627c01aaf34","triggerCount":0,"tags":[]}